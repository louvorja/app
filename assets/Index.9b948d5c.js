import{_ as C,bD as P,r as c,o as a,a as _,j as r,w as s,b as n,T as U,d as B,c as u,P as E,y as F,x as y,z as N,K as S,bE as x,g as k,n as W,M as j,F as D,e as R,N as K,av as O,H as z,t as T,O as q,V as A}from"./index.67b1b5c7.js";import{L as G}from"./Window.7fb38e50.js";import{L as J}from"./Slide.e968b711.js";import{V as L}from"./VSwitch.da648637.js";import"./VInput.17b4cf3b.js";import"./VSelectionControl.3a58b8be.js";const Q={name:"FullscreenPlayerComponent",components:{LPlayer:P},data(){return{visible:!1,start_timer:!0,timeout:null}},methods:{mouseMove(){!this.start_timer||(this.showChild(),this.startHideTimer())},mouseEnter(){this.start_timer=!1,clearTimeout(this.timeout)},mouseLeave(){this.start_timer=!0,this.startHideTimer()},showChild(){this.visible=!0,clearTimeout(this.timeout)},startHideTimer(){clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.visible=!1},1e3)}},beforeUnmount(){clearTimeout(this.timeout)}};function X(t,l,m,h,f,e){const g=c("l-player");return a(),_("div",{class:"position-absolute w-100 h-100 top-0 left-0",style:{"z-index":"9999"},onMousemove:l[2]||(l[2]=(...d)=>e.mouseMove&&e.mouseMove(...d))},[r(U,{name:"slide-up"},{default:s(()=>[f.visible?(a(),_("div",{key:0,class:"position-absolute w-100 bottom-0",onMouseenter:l[0]||(l[0]=(...d)=>e.mouseEnter&&e.mouseEnter(...d)),onMouseleave:l[1]||(l[1]=(...d)=>e.mouseLeave&&e.mouseLeave(...d))},[r(g,{location:"fullscreen"})],32)):n("",!0)]),_:1})],32)}const Y=C(Q,[["render",X],["__scopeId","data-v-71034165"]]),Z={name:"MediaComponent",components:{Window:G,LSlide:J,LPlayer:P,LFullscreenPlayer:Y},data:()=>({preview_height:0,scrollPos:0}),computed:{module_id(){return B.id},module(){return this.$modules.get(this.module_id)},userdata(){return new Proxy({},{get:(t,l)=>this.$userdata.get(`modules.${this.module.id}.${l}`,null),set:(t,l,m)=>(this.$userdata.set(`modules.${this.module.id}.${l}`,m),!0)})},is_online(){return this.$appdata.get("is_online")},loading(){return this.module.loading},config(){return this.$media.config()},slide_index(){var t;return(t=this.config)==null?void 0:t.slide_index},slides(){return this.$media.slides()},slide(){return this.$media.slide()},fullscreen:{get(){return this.module.config.fullscreen},set(t){this.$media.fullscreen(t)}},lazy_load:{get(){return this.$userdata.get("modules.media.lazy_load")},set(t){this.$userdata.set("modules.media.lazy_load",t)}},fade_audio:{get(){return this.$userdata.get("modules.media.fade_audio")},set(t){this.$userdata.set("modules.media.fade_audio",t)}}},watch:{slide_index(){var t,l,m;if(!!this.module.show&&((t=this.$refs)==null?void 0:t.slideItem)&&((m=(l=this.$refs)==null?void 0:l.slideItem[0])==null?void 0:m.$el)){let h=this,f=this.$refs.slideItem[0].$el.offsetHeight;setTimeout(function(){h.scrollPos=h.slide_index*f-f},100)}}},methods:{t(t){return this.$t(`modules.${this.module_id}.${t}`)},resize(t){this.preview_height=t.container_height}}},$={class:"d-flex flex-no-wrap align-stretch flex-row justify-space-between"},ee={class:"w-100"},te={key:0},le=["innerHTML"],ie=["src"];function se(t,l,m,h,f,e){var v,p,w,V;const g=c("l-slide"),d=c("l-fullscreen-player"),M=c("fullscreen"),I=c("l-player"),H=c("Window");return a(),u(H,{modelValue:e.module.show,"onUpdate:modelValue":l[4]||(l[4]=i=>e.module.show=i),title:(v=e.config)==null?void 0:v.title,subtitle:((p=e.config)==null?void 0:p.subtitle)+(((w=e.config)==null?void 0:w.track)>0?" | "+e.t("general.track")+" "+e.config.track:""),image:(V=e.config)!=null&&V.image?t.$path.file(e.config.image):"","title-class":"text-h4 font-weight-light",closable:"",minimizable:"",compact:"",compact_footer:"",onClose:l[5]||(l[5]=i=>t.$media.close()),onMinimize:l[6]||(l[6]=i=>t.$media.minimize()),onResize:e.resize,size:"large",scrollPos:t.scrollPos,dark:""},{system_buttons:s(()=>[e.is_online?(a(),u(E,{key:0},{activator:s(({props:i})=>[r(F,y(i,{class:"ms-2",icon:"mdi-menu",variant:"text",size:"small"}),null,16)]),default:s(()=>[r(N,null,{default:s(()=>[r(S,null,{default:s(()=>[r(x,{text:e.t("inputs.lazy_load_tooltip")},{activator:s(({props:i})=>[r(L,y({color:"blue"},i,{modelValue:e.lazy_load,"onUpdate:modelValue":l[0]||(l[0]=o=>e.lazy_load=o),label:e.t("inputs.lazy_load")}),null,16,["modelValue","label"])]),_:1},8,["text"]),r(x,{text:e.t("inputs.fade_audio_tooltip")},{activator:s(({props:i})=>[r(L,y({color:"blue"},i,{modelValue:e.fade_audio,"onUpdate:modelValue":l[1]||(l[1]=o=>e.fade_audio=o),label:e.t("inputs.fade_audio")}),null,16,["modelValue","label"])]),_:1},8,["text"])]),_:1})]),_:1})]),_:1})):n("",!0)]),footer:s(()=>[r(I,{location:"window"})]),default:s(()=>[k("div",$,[k("div",ee,[r(M,{modelValue:e.fullscreen,"onUpdate:modelValue":l[2]||(l[2]=i=>e.fullscreen=i),class:"position-sticky w-100",style:W(`top: 0; height:${t.preview_height}px; overflow: hidden;`)},{default:s(()=>[e.slide?(a(),u(g,{key:0,slide_number:e.config.slide_index,cover:e.slide.cover==!0,text:e.slide.lyric,aux_text:e.slide.aux_lyric,image:e.slide.url_image?t.$path.file(e.slide.url_image):null,image_position:e.slide.image_position},null,8,["slide_number","cover","text","aux_text","image","image_position"])):n("",!0),e.fullscreen?(a(),u(d,{key:1})):n("",!0)]),_:1},8,["modelValue","style"])]),t.$vuetify.display.width>600?(a(),_("div",te,[r(j,{class:"overflow h-100 ma-0 pa-0","bg-color":"black",width:250},{default:s(()=>[(a(!0),_(D,null,R(e.slides,(i,o)=>(a(),u(K,{onClick:b=>t.$media.goToSlide(o),key:o,link:"",active:e.config.slide_index===o,ref_for:!0,ref:"slideItem",variant:"tonal",height:58},{prepend:s(()=>[r(O,{class:"mr-2"},{default:s(()=>[z(T(o+1),1)]),_:2},1024)]),default:s(()=>[i.cover?(a(),u(q,{key:0},{default:s(()=>[z(T(i.lyric),1)]),_:2},1024)):(a(),_("div",{key:1,class:"text-caption text-truncate",innerHTML:i.lyric},null,8,le)),e.config.audio!=""&&e.config.slide_index==o?(a(),u(A,{key:2,modelValue:e.config.slide_progress,"onUpdate:modelValue":l[3]||(l[3]=b=>e.config.slide_progress=b),indeterminate:e.loading,height:5,color:e.config.is_paused?"orange":"white"},null,8,["modelValue","indeterminate","color"])):n("",!0),i.url_image?(a(),_("img",{key:3,src:t.$path.file(i.url_image),style:{display:"none"}},null,8,ie)):n("",!0)]),_:2},1032,["onClick","active"]))),128))]),_:1})])):n("",!0)])]),_:1},8,["modelValue","title","subtitle","image","onResize","scrollPos"])}const me=C(Z,[["render",se]]);export{me as default};

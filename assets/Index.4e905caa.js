import{be as C,a7 as k,o as i,c as s,w as o,aE as w,j as d,P as $,y as V,x as b,M as p,a as g,F as m,e as y,N as h,J as D,bf as _,b as c,V as A,g as u,z as B,n as M,C as j,D as z,t as v,b7 as L}from"./index.67b1b5c7.js";import{M as N}from"./ModuleContainer.0968272b.js";import{V as S}from"./VAlert.178086c5.js";import"./Window.7fb38e50.js";const F={class:"d-flex flex-wrap justify-center"},P={class:"d-flex flex-no-wrap justify-space-between align-center"},T={class:"flex-grow-1 d-flex flex-column"},x=["textContent"],E=["textContent"],I={name:C.id,data:()=>({categories:[],lang:null,id_category:null,loading:!1,error:null}),computed:{albums(){var l;return this.categories?this.id_category?(l=this.categories.filter(a=>a.id_category==this.id_category)[0])==null?void 0:l.albums.sort((a,r)=>a.order-r.order):[...new Map(this.categories.reduce((a,r)=>a.concat(r.albums),[]).map(a=>[a.id_album,{...a,subtitle:null}])).values()].sort((a,r)=>this.$string.sort(a.name,r.name)):[]},compact:function(){return this.$vuetify.display.width<=600}},methods:{async loadData(){if(this.id_category=null,this.categories=[],this.loading=!0,this.categories=await this.$database.get(`${this.$i18n.locale}_categories`),this.categories==null){this.$modules.close(this.module_id);return}this.categories.length>0?(this.categories.sort((l,a)=>l.order-a.order),this.id_category=this.categories[0].id_category):this.id_category=0,this.lang=this.$i18n.locale,this.loading=!1},setCategory(l=null){this.id_category=l},openAlbum(l){this.$media.openAlbum(l)},async show(l){l&&this.lang!=this.$i18n.locale?await this.loadData():l&&this.categories.length>0&&this.id_category==null&&(this.id_category=this.categories[0].id_category)},close(){this.id_category=null}},async mounted(){await this.loadData()}},H=Object.assign(I,{setup(l){const a=k(null),r=e=>{var n;return((n=a.value)==null?void 0:n.t(e))||e};return(e,n)=>(i(),s(N,{ref_key:"moduleContainer",ref:a,manifest:L(C),onShow:e.show,onClose:e.close},{header:o(()=>[e.compact?(i(),s(w,{key:0,color:"transparent"},{prepend:o(()=>[d($,null,{activator:o(({props:t})=>[d(V,b({icon:"$menu"},t),null,16)]),default:o(()=>[d(p,{color:e.$theme.primary(),class:"d-flex flex-column h-100"},{default:o(()=>[(i(!0),g(m,null,y(e.categories,t=>(i(),s(h,{key:t.id_category,title:t.name,active:e.id_category==t.id_category,onClick:f=>e.setCategory(t.id_category)},null,8,["title","active","onClick"]))),128)),d(D),d(h,{class:"mt-auto",title:r("all_collections"),active:e.id_category==0,onClick:n[0]||(n[0]=t=>e.setCategory(0))},null,8,["title","active"])]),_:1},8,["color"])]),_:1})]),default:o(()=>[!e.id_category||e.id_category==0?(i(),s(_,{key:0,class:"text-h6",text:r("all_collections")},null,8,["text"])):(i(),s(_,{key:1,class:"text-h6",text:e.categories.find(t=>t.id_category==e.id_category).name},null,8,["text"]))]),_:1})):c("",!0)]),left:o(()=>[e.compact?c("",!0):(i(),s(p,{key:0,color:e.$theme.primary(),width:200,class:"d-flex flex-column h-100"},{default:o(()=>[e.loading?(i(),s(A,{key:0,color:e.$theme.primary(),indeterminate:""},null,8,["color"])):c("",!0),(i(!0),g(m,null,y(e.categories,t=>(i(),s(h,{key:t.id_category,title:t.name,active:e.id_category==t.id_category,onClick:f=>e.setCategory(t.id_category)},null,8,["title","active","onClick"]))),128)),d(h,{class:"mt-auto",title:r("all_collections"),active:e.id_category==0,onClick:n[1]||(n[1]=t=>e.setCategory(0))},null,8,["title","active"])]),_:1},8,["color"]))]),default:o(()=>[e.error?(i(),s(S,{key:0,type:"error",text:e.error,variant:"tonal",border:"start",class:"ma-2"},null,8,["text"])):c("",!0),u("div",F,[(i(!0),g(m,null,y(e.albums,t=>(i(),s(B,{style:M(e.$vuetify.display.width>350?"min-width: 300px; max-width: 300px":"width:100%"),theme:"dark",key:t.id_album,width:"320",class:"ma-2",color:t.color||"#385F73",dark:"",onClick:f=>e.openAlbum(t.id_album)},{default:o(()=>[u("div",P,[t.url_image?(i(),s(j,{key:0,class:"ma-3",size:e.$vuetify.display.width>350?125:75,tile:"",rounded:"0"},{default:o(()=>[d(z,{src:e.$path.file(t.url_image)},null,8,["src"])]),_:2},1032,["size"])):c("",!0),u("div",T,[u("div",{class:"text-h6 pt-2",textContent:v(t.name)},null,8,x),u("div",{class:"h6",textContent:v(t.subtitle)},null,8,E)])])]),_:2},1032,["style","color","onClick"]))),128))])]),_:1},8,["manifest","onShow","onClose"]))}});export{H as default};
